(window.webpackJsonp=window.webpackJsonp||[]).push([[100],{426:function(e,t,s){"use strict";s.r(t);var r=s(4),a=Object(r.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"pv-pvc-概念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pv-pvc-概念"}},[e._v("#")]),e._v(" PV & PVC 概念")]),e._v(" "),t("h2",{attrs:{id:"简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[e._v("#")]),e._v(" 简介")]),e._v(" "),t("p",[e._v("上一节介绍的 Volume 可以直接连 NFS、GFS、Ceph 等存储集群，挂载到 Pod 中的容器里。本节介绍的 PV 也可以连这些存储集群，然后通过 Volume 挂载给容器使用。")]),e._v(" "),t("p",[e._v("既然 Volume 可以直接挂载存储，为什么还要有 PV 这种资源呢？当使用 Volume 直接挂载存储的时候，需要配置 NFS、GFS、Ceph 等多种类型的卷，这对于 k8s 管理员肯定是知道的，但是对于用户来说只关心部署的应用需要申请一块存储，不关心底层繁琐的细节。")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://cc.hjfile.cn/cc/img/20220517/2022051711141493140927.png",alt:"直接挂载存储"}})]),e._v(" "),t("p",[e._v("出于用户角度考虑，k8s 引入了 PV 和 PVC 的概念，用来管理 k8s 的存储。")]),e._v(" "),t("ul",[t("li",[e._v("PV（PersistentVolume）：由 k8s 配置的存储，没有 Namespace 隔离，可由 k8s 管理员提供。")]),e._v(" "),t("li",[e._v("PVC（PersistentVolumeClaim）：对 PV 的申请，有 Namespace 隔离，可由开发来定义。")])]),e._v(" "),t("p",[e._v("PV 是集群中的存储资源，PVC 是对这些存储资源的请求。他们都是 k8s 的一类资源对象，可以通过 yaml 来定义。PV 由管理员创建，连接对应的存储，用户要用存储的时候只需要创建 PVC 来描述申领的存储，k8s 系统会根据规则自动将 PVC 和 PV 绑定，用户在工作负载中通过 PVC 挂载卷就好了。")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://cc.hjfile.cn/cc/img/20220517/2022051711075219286142.png",alt:"通过PVC挂载存储"}})]),e._v(" "),t("h2",{attrs:{id:"详解"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#详解"}},[e._v("#")]),e._v(" 详解")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://kubernetes.io/zh/docs/concepts/storage/persistent-volumes/#lifecycle-of-a-volume-and-claim",target:"_blank",rel:"noopener noreferrer"}},[e._v("PV 和 PVC 的声明周期"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://kubernetes.io/zh/docs/concepts/storage/persistent-volumes/#persistent-volumes",target:"_blank",rel:"noopener noreferrer"}},[e._v("PV 详细介绍"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://kubernetes.io/zh/docs/concepts/storage/persistent-volumes/#persistentvolumeclaims",target:"_blank",rel:"noopener noreferrer"}},[e._v("PVC 详细介绍"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://kubernetes.io/zh/docs/concepts/storage/persistent-volumes/#claims-as-volumes",target:"_blank",rel:"noopener noreferrer"}},[e._v("通过 PVC 挂载卷"),t("OutboundLink")],1)])]),e._v(" "),t("h1",{attrs:{id:"pv-pvc-的使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pv-pvc-的使用"}},[e._v("#")]),e._v(" PV & PVC 的使用")]),e._v(" "),t("h2",{attrs:{id:"使用示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用示例"}},[e._v("#")]),e._v(" 使用示例")]),e._v(" "),t("p",[e._v("参阅官方示例："),t("a",{attrs:{href:"https://kubernetes.io/zh/docs/tasks/configure-pod-container/configure-persistent-volume-storage",target:"_blank",rel:"noopener noreferrer"}},[e._v("配置 Pod 以使用 PersistentVolume 作为存储"),t("OutboundLink")],1),e._v("，了解 PV 和 PVC 是如何定义的，PVC 和 PV 是如何绑定的，工作负载中如何通过 PVC 挂载卷。")]),e._v(" "),t("h2",{attrs:{id:"可能遇到的问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#可能遇到的问题"}},[e._v("#")]),e._v(" 可能遇到的问题")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("有时候创建 PVC 之后，一直绑定不上 PV（Pending），可能是：")]),e._v(" "),t("ul",[t("li",[e._v("PVC 申请的空间大于 PV 的大小")]),e._v(" "),t("li",[e._v("PVC 和 PV 的 StorageClassName 不一致")]),e._v(" "),t("li",[e._v("PVC 和 PV 的 accessModes 不一致")])])]),e._v(" "),t("li",[t("p",[e._v("创建挂载了 PVC 的 Pod 之后，一直处于 Pending 状态，可能是：")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("PVC 没有被创建成功，或者被创建")])]),e._v(" "),t("li",[t("p",[e._v("PVC 和 Pod 不在同一个 Namespace")])])])])]),e._v(" "),t("h1",{attrs:{id:"相关官方文档"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#相关官方文档"}},[e._v("#")]),e._v(" 相关官方文档")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://kubernetes.io/zh/docs/concepts/storage/persistent-volumes/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Persistent Volume"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://kubernetes.io/zh/docs/tasks/configure-pod-container/configure-persistent-volume-storage",target:"_blank",rel:"noopener noreferrer"}},[e._v("配置 Pod 以使用 PersistentVolume 作为存储"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=a.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{353:function(a,s,t){"use strict";t.r(s);var n=t(4),e=Object(n.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"_9-1-配置管理介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-配置管理介绍"}},[a._v("#")]),a._v(" 9.1 配置管理介绍")]),a._v(" "),s("p",[a._v("为什么要实现配置管理?")]),a._v(" "),s("ul",[s("li",[a._v("不同环境，不同配置")]),a._v(" "),s("li",[a._v("配置属性动态刷新")])]),a._v(" "),s("p",[s("img",{attrs:{src:"C:%5CUsers%5Cwanggaosheng%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210308103619781.png",alt:"image-20210308103619781"}})]),a._v(" "),s("h2",{attrs:{id:"_9-2-配置示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-配置示例"}},[a._v("#")]),a._v(" 9.2 配置示例")]),a._v(" "),s("p",[a._v("nacos配置管理的配置文件是bootstrap.yml，其中也有server-addr配置，这是因为Spring Cloud Alibaba将服务发现和配置管理区分开了，nacos服务发现的集群和nacos配置管理的集群可以分离，这样职责单一，性能也更好。")]),a._v(" "),s("p",[a._v("加依赖")]),a._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("com.alibaba.cloud"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("spring-cloud-starter-alibaba-nacos-config"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("p",[a._v("写配置，resource目录下新建bootstrap.yml文件")]),a._v(" "),s("div",{staticClass:"language-yml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spring")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("cloud")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("nacos")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("config")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("server-addr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 127.0.0.1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8848")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("file-extension")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" yaml\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("application")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" content"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("center\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("profiles")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("active")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" dev\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br")])]),s("p",[a._v("配置，nacos配置约定，对应的地方必须一样")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://s3.ax1x.com/2021/03/08/6Qe76S.png",alt:"image-20210305175109417"}})]),a._v(" "),s("p",[a._v("在 Nacos Spring Cloud 中，"),s("code",[a._v("dataId")]),a._v(" 的完整格式如下：")]),a._v(" "),s("div",{staticClass:"language-plain line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-plain"}},[s("code",[a._v("${prefix}-${spring.profiles.active}.${file-extension}\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[s("p",[s("code",[a._v("prefix")]),a._v(" 默认为 "),s("code",[a._v("spring.application.name")]),a._v(" 的值，也可以通过配置项 "),s("code",[a._v("spring.cloud.nacos.config.prefix")]),a._v("来配置。")])]),a._v(" "),s("li",[s("p",[s("code",[a._v("spring.profiles.active")]),a._v(" 即为当前环境对应的 profile。")]),a._v(" "),s("blockquote",[s("p",[s("strong",[a._v("注意：当 "),s("code",[a._v("spring.profiles.active")]),a._v(" 为空时，对应的连接符 "),s("code",[a._v("-")]),a._v(" 也将不存在，dataId 的拼接格式变成 "),s("code",[a._v("${prefix}.${file-extension}")])])])])]),a._v(" "),s("li",[s("p",[s("code",[a._v("file-exetension")]),a._v(" 为配置内容的数据格式，可以通过配置项 "),s("code",[a._v("spring.cloud.nacos.config.file-extension")]),a._v(" 来配置。目前只支持 "),s("code",[a._v("properties")]),a._v(" 和 "),s("code",[a._v("yaml")]),a._v(" 类型。")])])]),a._v(" "),s("p",[a._v("上图是通过控制台操作配置，也可以通过调用API操作配置。Spring Boot和Spring Cloud等使用示例，参考官网示例。配置历史版本回滚见控制台对应页面即可。")]),a._v(" "),s("p",[a._v("参考：")]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://nacos.io/zh-cn/docs/quick-start-spring-cloud.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("官网文档"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://spring-cloud-alibaba-group.github.io/github-pages/hoxton/en-us/index.html#_spring_cloud_alibaba_nacos_config",target:"_blank",rel:"noopener noreferrer"}},[a._v("Spring官方文档"),s("OutboundLink")],1)])]),a._v(" "),s("h2",{attrs:{id:"_9-3-应用配置共享"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-3-应用配置共享"}},[a._v("#")]),a._v(" 9.3 应用配置共享")]),a._v(" "),s("h3",{attrs:{id:"_9-3-1-同一服务不同环境共享"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-3-1-同一服务不同环境共享"}},[a._v("#")]),a._v(" 9.3.1 同一服务不同环境共享：")]),a._v(" "),s("p",[a._v("上小节中，如果nacos控制台不配置 "),s("code",[a._v("spring.profiles.active")]),a._v("，表示这是应用在所有环境下的通用配置，例如"),s("code",[a._v("dev")]),a._v("和"),s("code",[a._v("prod")]),a._v("都可以读取到该配置，但是指定环境的配置优先于通用环境配置。")]),a._v(" "),s("h3",{attrs:{id:"_9-3-2-不同服务共享"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-3-2-不同服务共享"}},[a._v("#")]),a._v(" 9.3.2 不同服务共享")]),a._v(" "),s("p",[a._v("有些配置在所有服务中都是一样的，例如数据库连接以及一些业务配置等。有两种配置方式")]),a._v(" "),s("p",[a._v("方式1、shared-dataids")]),a._v(" "),s("div",{staticClass:"language-yml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spring.cloud.nacos.config")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#共享配置的DataId，多个使用，分隔 ")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#越靠后，优先级越高；common2.yml > common1.yaml ")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#.yaml后缀不能少，只支持 yaml/properties ")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("shared-dataids")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" common1.yamL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("common2.yamL \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#哪些共享配置支持动态刷新，多个使用，分隔 ")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("refreshable-dataids")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" common1.yaml \n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("server-addr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 127.0.0.1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8848")]),a._v(" \n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("file-extension")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" yaml\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br")])]),s("p",[a._v("方式二、ext-config")]),a._v(" "),s("div",{staticClass:"language-yml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spring.cloud.nacos.config")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("server-addr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 127.0.0.1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8848")]),a._v(" \n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("file-extension")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" yaml \n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("ext-config")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#需共享的DataId，yaml后缀不能少，只支持yaml/properties ")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#越靠后，优先级越高优先级common2.yaml > common1.yaml ")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("data-id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" common1.yaml \n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#common1.yaml所在的group ")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("group")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" DEFAULT_GROUP \n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#是否允许刷新，默认false ")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("refresh")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("true")]),a._v(" \n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("data-id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" common2.yaml \n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("group")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" DEFAULT_GROUP \n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("refresh")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("true")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br")])]),s("h3",{attrs:{id:"_9-3-3-配置方式优先级"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-3-3-配置方式优先级"}},[a._v("#")]),a._v(" 9.3.3 配置方式优先级")]),a._v(" "),s("p",[a._v("现在已经有3种配置方式了")]),a._v(" "),s("ul",[s("li",[a._v("nacos根据${prefix}、${spring.profiles.active}和${file-extension} 自动获取配置")]),a._v(" "),s("li",[a._v("ext-config")]),a._v(" "),s("li",[a._v("shared-dataids")])]),a._v(" "),s("p",[a._v("三种方式的优先级如下：")]),a._v(" "),s("p",[a._v("自动配置 > ext-config > shared-dataids")]),a._v(" "),s("h2",{attrs:{id:"_9-4-引导上下文"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-4-引导上下文"}},[a._v("#")]),a._v(" 9.4 引导上下文")]),a._v(" "),s("h3",{attrs:{id:"_9-4-1-引导上下文介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-4-1-引导上下文介绍"}},[a._v("#")]),a._v(" 9.4.1 引导上下文介绍")]),a._v(" "),s("ul",[s("li",[a._v("引导上下文用于连接配置服务器，读取外部配置")]),a._v(" "),s("li",[a._v("引导上下文是Application Context的父上下文")])]),a._v(" "),s("p",[a._v("引导上下文的一个比较特殊的上下文，它用来==连接配置服务器，读取外部配置==，bootstrap.yml就是引导上下文的配置文件。对于我们的应用，他就是用于连接nacos，读取nacos里面的配置。")]),a._v(" "),s("blockquote",[s("p",[a._v("Application Context 和之前的 Ribbon、Feign也都是父子上下文关系")])]),a._v(" "),s("h3",{attrs:{id:"_9-4-2-配置项优先级"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-4-2-配置项优先级"}},[a._v("#")]),a._v(" 9.4.2 配置项优先级")]),a._v(" "),s("p",[a._v("当项目又有远程配置，又有本地配置，远程配置优先于本地配置")]),a._v(" "),s("p",[a._v("如果想让本地配置覆盖远程配置，可以根据以下方式配置。需要注意的是，这段配置要放在有远程配置中。")]),a._v(" "),s("div",{staticClass:"language-yml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spring")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("cloud")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("config")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#是否允许本地配置覆盖远程配置")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("allow-override")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("true")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#是否一切以本地配置为准，默认false")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("override-none")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("false")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#系统环境变量或系统属性才能覆盖远程配置文件的配置")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#本地配置文件中配置优先级低于远程配置，默认true")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("override-system-properties")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("true")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br")])]),s("h2",{attrs:{id:"_9-5-nacos数据持久化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-5-nacos数据持久化"}},[a._v("#")]),a._v(" 9.5 Nacos数据持久化")]),a._v(" "),s("h3",{attrs:{id:"_9-5-1-nacos的各种数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-5-1-nacos的各种数据"}},[a._v("#")]),a._v(" 9.5.1 Nacos的各种数据")]),a._v(" "),s("p",[a._v("Nacos不同用途的数据存储在不同的目录，Nacos提供两种不同服务时的数据路径如下：")]),a._v(" "),s("ul",[s("li",[a._v("服务发现组件\n"),s("ul",[s("li",[a._v("数据存储在：~/nacos/naming")])])]),a._v(" "),s("li",[a._v("配置服务器\n"),s("ul",[s("li",[a._v("配置数据：$NACOS_HOME/data/derby-data")]),a._v(" "),s("li",[a._v("快照等：~/nacos/config")])])])]),a._v(" "),s("p",[a._v("Nacos的上述三种数据都是持久化存储的，其中配置服务器快照是用于提升性能和容灾的，配置数据是存储在Nacos内嵌的Apache下的数据库derby，配置数据存储在这里是不能用于生产环境的，内嵌的小型数据库高可用是个问题")]),a._v(" "),s("blockquote",[s("p",[a._v("可以使用derby客户端连接Nacos内嵌的derby数据库（IDEA就支持连接），路径在 $NACOS_HOME/data/derby-data，用户名密码都是 nacos")])]),a._v(" "),s("h3",{attrs:{id:"_9-5-2-搭建生产可用的nacos集群"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-5-2-搭建生产可用的nacos集群"}},[a._v("#")]),a._v(" 9.5.2 搭建生产可用的Nacos集群")]),a._v(" "),s("p",[a._v("要搭建生产可用的Nacos集群，要实现Nacos集群本身的高可用，以及数据库的高可用。")]),a._v(" "),s("p",[a._v("参考：")]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://nacos.io/zh-cn/docs/deployment.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("官方部署文档"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://www.imooc.com/article/288153",target:"_blank",rel:"noopener noreferrer"}},[a._v("搭建生产可用的Nacos集群手记"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=e.exports}}]);
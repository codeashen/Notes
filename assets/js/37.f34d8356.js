(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{362:function(t,s,a){"use strict";a.r(s);var n=a(4),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"一、生产者核心参数详解"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、生产者核心参数详解"}},[t._v("#")]),t._v(" 一、生产者核心参数详解")]),t._v(" "),s("ul",[s("li",[t._v("producerGroup(组名)：在一个应用中唯一，如果启动两个相同名称的producer会报错。")]),t._v(" "),s("li",[t._v("createTopic：创建topic，生产中不允许producer直接创建topic")]),t._v(" "),s("li",[t._v("defaultTopicQueueNums：默认队列数量，默认为4")]),t._v(" "),s("li",[t._v("sendMsgTimeout：发送超时时间（单位：ms）")]),t._v(" "),s("li",[t._v("compressMsgBodyOverHowmuch：消息达到多大会进行压缩，以提升性能。默认4096字节")]),t._v(" "),s("li",[t._v("retryTimesWhenSendFailed：重发次数，可配置")]),t._v(" "),s("li",[t._v("retryAnotherBrokerWhenNotStoreOK：消息存储失败是否重试其他broker，默认false")]),t._v(" "),s("li",[t._v("maxMessageSize：消息大小限制")])]),t._v(" "),s("blockquote",[s("p",[t._v("生产消费者都可能设置一些限制，那消息是消息在生产者端就不会发出去，还是到了消费者端才拒绝呢？其实是Producer和Consumer启动的时候都会去NameServer拉取元数据信息，保存在本地，在发消息的时候就会已经被拒绝了。")])]),t._v(" "),s("h1",{attrs:{id:"二、主从同步机制分析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、主从同步机制分析"}},[t._v("#")]),t._v(" 二、主从同步机制分析")]),t._v(" "),s("p",[t._v("Master - Slave 主从同步有两个部分，元数据同步 + 消息同步")]),t._v(" "),s("ul",[s("li",[t._v("元数据同步：Broker角色识别，为slave则启动同步任务。同步topic的配置信息，消费者offest信息等，启动定时任务同步，非实时。")]),t._v(" "),s("li",[t._v("消息数据同步：commitLog数据，实时同步。")])]),t._v(" "),s("blockquote",[s("p",[t._v("消息同步相关代码：HAService、HAconnection、WaitNotfiyObject")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th",[t._v("元数据同步")]),t._v(" "),s("th",[t._v("消息同步")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("同步内容")]),t._v(" "),s("td",[t._v("一些配置信息，如Topic信息，Consumer Offset信息，delay信息，subscribe信息等")]),t._v(" "),s("td",[t._v("真实的消息内容，CommitLog")])]),t._v(" "),s("tr",[s("td",[t._v("同步时机")]),t._v(" "),s("td",[t._v("定时任务同步")]),t._v(" "),s("td",[t._v("实时同步")])]),t._v(" "),s("tr",[s("td",[t._v("同步方式")]),t._v(" "),s("td",[t._v("Broker角色识别，为Slave则启动同步任务")]),t._v(" "),s("td",[t._v("核心思想是不断对比Master和Slave的Offset，Master和Slave不断轮询读写状态位，以判断是否需要同步")])]),t._v(" "),s("tr",[s("td",[t._v("实现机制")]),t._v(" "),s("td",[t._v("Netty")]),t._v(" "),s("td",[t._v("原生Socket")])])])]),t._v(" "),s("h1",{attrs:{id:"三、消息发送机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、消息发送机制"}},[t._v("#")]),t._v(" 三、消息发送机制")]),t._v(" "),s("h2",{attrs:{id:"_3-1-同步发送和异步发送"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-同步发送和异步发送"}},[t._v("#")]),t._v(" 3.1 同步发送和异步发送")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th",[t._v("同步发送")]),t._v(" "),s("th",[t._v("异步发送")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("发送方法")]),t._v(" "),s("td",[t._v("producer.send(Message)")]),t._v(" "),s("td",[t._v("producer.send(Message, SendCallBack)")])]),t._v(" "),s("tr",[s("td",[t._v("核心实现")]),t._v(" "),s("td",[t._v("DefaultMQProducerImpl")]),t._v(" "),s("td",[t._v("DefaultMQProducerImpl")])])])]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 同步发送消息")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// SendResult result = producer.send(message);")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// System.err.println("消息发出：" + result);')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 异步发送消息")]),t._v("\nproducer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SendCallback")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("onSuccess")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SendResult")]),t._v(" sendResult"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"msgId: %s, sendStatus: %s\\n"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sendResult"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getMsgId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sendResult"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getSendStatus")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("onException")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Throwable")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"------发送失败------"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br")])]),s("h2",{attrs:{id:"_3-2-rocketmq底层netty解析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-rocketmq底层netty解析"}},[t._v("#")]),t._v(" 3.2 RocketMQ底层Netty解析")]),t._v(" "),s("p",[t._v("RocketMQ中remoting模块基于netty实现，根据下图，介绍其中核心类。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://z3.ax1x.com/2021/06/15/2b8Z26.png",alt:"image-20210615151114105"}})]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("接口/类")]),t._v(" "),s("th",[t._v("含义")]),t._v(" "),s("th",[t._v("方法")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("RemotingService")]),t._v(" "),s("td",[t._v("客户端服务端上层接口")]),t._v(" "),s("td",[t._v("启动、关闭、回调")])]),t._v(" "),s("tr",[s("td",[t._v("RemotingClient")]),t._v(" "),s("td",[t._v("客户端接口，继承RemotingService")]),t._v(" "),s("td",[t._v("更新NameServ、发送消息、注册")])]),t._v(" "),s("tr",[s("td",[t._v("RemotingServer")]),t._v(" "),s("td",[t._v("服务端接口，继承RemotingService")]),t._v(" "),s("td",[t._v("注册、获取程序Pair、发送消息")])]),t._v(" "),s("tr",[s("td",[t._v("NettyRemotingClient")]),t._v(" "),s("td",[t._v("客户端实现类，"),s("br"),t._v("继承NettyRemotingAbstract，"),s("br"),t._v("实现RemotingClient")]),t._v(" "),s("td",[t._v("RemotingClient方法实现，发送消息方法直接调用NettyRemotingAbstract的方法实现")])]),t._v(" "),s("tr",[s("td",[t._v("NettyRemotingServer")]),t._v(" "),s("td",[t._v("服务端实现类，"),s("br"),t._v("继承NettyRemotingAbstract，"),s("br"),t._v("实现RemotingServer")]),t._v(" "),s("td",[t._v("RemotingServer方法实现，发送消息方法直接调用NettyRemotingAbstract的方法实现")])]),t._v(" "),s("tr",[s("td",[t._v("NettyRemotingAbstract")]),t._v(" "),s("td",[t._v("抽象类，封装公共具体发消息实现")]),t._v(" "),s("td",[t._v("真正发送消息方法")])])])]),t._v(" "),s("p",[t._v("RocketMQ中Netty自定义的协议栈结构如下，发送的数据遵循该结构。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://z3.ax1x.com/2021/06/15/2bBhPU.png",alt:"image-20210615160204916"}})]),t._v(" "),s("h2",{attrs:{id:"_3-2-消息的返回状态"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-消息的返回状态"}},[t._v("#")]),t._v(" 3.2 消息的返回状态")]),t._v(" "),s("p",[t._v("RocketMQ生产者发送消息会返回SendResult对象，其中sendStatus属性描述了发送状态，有以下4种状态：")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("SEND_OK")]),t._v("：消息发送成功。")]),t._v(" "),s("li",[s("strong",[t._v("FLUSH_DISK_TIMEOUT")]),t._v("：消息发送成功，但是刷盘超时。会等下一次刷盘的时候再次刷盘。但是在此期间如果宕机消息会丢失。")]),t._v(" "),s("li",[s("strong",[t._v("FLUSH_SLAVE_TIMEOUT")]),t._v("：消息发送成功，但是消息同步到Slave超时。Slave宕机，会丢失消息。")]),t._v(" "),s("li",[s("strong",[t._v("SLAVE_NOT_AVAILABLE")]),t._v("：消息发送成功，但是Slave不可用。Master宕机消息丢失。")])]),t._v(" "),s("p",[t._v("出现后三种情况，考虑做补偿处理，比如可靠性重投。")]),t._v(" "),s("h1",{attrs:{id:"四、消息延迟投递"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、消息延迟投递"}},[t._v("#")]),t._v(" 四、消息延迟投递")]),t._v(" "),s("ul",[s("li",[t._v("延迟消息：消息发送到Broker后，要特定的时间后才会被Consumer消费")]),t._v(" "),s("li",[t._v("只支持固定精度的延迟消息：内部就是一个定时任务，等到了符合的是将才将消息对Consumer可见")]),t._v(" "),s("li",[t._v("Message.setDelayTimeLevel：设置延迟级别方法，不同级别表示不同的固定精度")])]),t._v(" "),s("blockquote",[s("ul",[s("li",[t._v("固定精度值得是，内置设定的几个延时时间，不支持随意设置延时时间。因为考虑到定时任务扫描方便，防止排序浪费性能。")]),t._v(" "),s("li",[t._v("MessageStoreConfig：配置类，配置里固定精度，messageDelayLevel")]),t._v(" "),s("li",[t._v("ScheduleMessageService：任务类，定时任务")])])]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Message")]),t._v(" message "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Message")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test_quick_topic"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TagA"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"key1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello RocketMQ "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBytes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置延迟级别")]),t._v("\nmessage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setDelayTimeLevel")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SendResult")]),t._v(" result "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" producer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/*\n延迟级别在 MessageStoreConfig 类的 messageDelayLevel 中有规定\nprivate String messageDelayLevel = "1s 5s 10s 30s 1m 2m 3m 4m 5m 6m 7m 8m 9m 10m 20m 30m 1h 2h";\n*/')]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("p",[t._v("对于生产者来说，消息投递成功后马上返回结果；对于消费者，只有等到延迟时间后，才会消费到消息。")]),t._v(" "),s("h1",{attrs:{id:"五、消息自定义投递"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#五、消息自定义投递"}},[t._v("#")]),t._v(" 五、消息自定义投递")]),t._v(" "),s("p",[t._v("默认发送方法，消息会被轮流发送到topic的每个队列中，消费者消费时也会根据负载均衡策略从各个队列中获取消息。")]),t._v(" "),s("p",[t._v("通过以下发送方法的重载，可以发送消息到topic的指定队列。")]),t._v(" "),s("p",[s("code",[t._v("sendMessage(Message, MessageQueueSelector, Object)")]),t._v("：参数分别为，消息，队列选择器，投递参数。投递参数会传到队列选择器"),s("code",[t._v("select")]),t._v("方法的第三个参数上。")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 自定义投递")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SendResult")]),t._v(" sendResult "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" producer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MessageQueueSelector")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 参数一:队列List, 参数二:消息, 参数三: 发送参数")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 返回要投递的队列")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MessageQueue")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("select")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MessageQueue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" mqs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Message")]),t._v(" msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),t._v(" arg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),t._v(" queueNumber "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" arg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" mqs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("queueNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//投递参数2会传到select方法上")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sendResult"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getMessageQueue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getQueueId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br")])])])}),[],!1,null,null,null);s.default=e.exports}}]);